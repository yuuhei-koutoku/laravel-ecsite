# EC サイト

# 使用技術、開発環境

-   フロントエンド
    -   HTML
    -   CSS
        -   Tailwind CSS 3.1.0
-   バックエンド
    -   PHP 8.2.0
        -   Laravel 9.52.5
-   その他
    -   MAMP
        -   MySQL 5.7.39
        -   Apache
    -   Visual Studio Code
    -   Git / GitHub / SourceTree

# 機能一覧

-   ユーザー（商品の購入を目的として利用する）
    -   アカウント新規作成、ログイン、ログアウト
    -   商品一覧
        -   商品画像、カテゴリー、商品名、単価を表示
        -   カテゴリ検索
        -   キーワード検索
        -   CSVダウンロード（全てのページ または 現在のページのみ）
        -   並び替え（おすすめ順、料金が高い順、料金が安い順、新しい順、古い順）
        -   ページネーション（表示件数切り替え（20 件、50 件、100 件））
    -   商品詳細
        -   商品画像切り替え（Swiper.js）
        -   詳細情報表示（カテゴリ、商品名、商品の説明、単価）
        -   カートに入れる
        -   ショップの詳細を表示（Micromodal.js）
    -   カートを表示
        -   カートに入れた商品を表示（商品画像、商品名、数量、小計、合計金額）
        -   カートに入れた商品を削除
        -   カートに入れた商品の合計金額を表示
    -   購入（Stripe）
        -   カートに入れた商品を表示（商品名、数量、単価、小計、合計金額）
        -   支払いに必要な情報を入力（メールアドレス、カード情報、カード所有者名、国または地域）
        -   購入確定後、ユーザーとオーナーにメール送信を行う（Mailtrap）
    -   お問い合わせ
        -   運営へ問い合わせ内容を送信
        -   メッセージの送信を取り消し（論理削除）
    -   プロフィール
        -   購入履歴を表示
        -   プロフィール情報（名前、メールアドレス）を更新
        -   パスワード更新
        -   アカウント退会
-   オーナー（商品の販売を目的として利用する）
    -   ログイン、ログアウト
    -   店舗情報
        -   店名及び店舗画像を表示
        -   詳細
            -   更新（店名、店舗情報、店舗画像アップロード、販売中 or 停止中）
    -   画像管理
        -   商品画像一覧
        -   新規登録（商品画像アップロード）
        -   詳細
            -   商品画像タイトル更新
            -   商品画像削除
    -   商品管理
        -   商品一覧
        -   新規登録（商品名、商品情報、価格、表示順、初期在庫、販売する店舗、カテゴリー、複数画像アップロード、販売中 or 停止中）
        -   詳細
            -   更新（商品名、商品情報、価格、表示順、初期在庫、販売する店舗、カテゴリー、複数画像アップロード、販売中 or 停止中）
            -   商品削除
-   管理者（EC サイトを管理する）
    -   ログイン、ログアウト
    -   オーナー管理
        -   オーナー管理
            -   名前、メールアドレス、作成日を表示
            -   ページネーション
        -   新規登録（オーナー名、メールアドレス、パスワード、パスワード確認）
        -   更新（オーナー名、メールアドレス、店名、パスワード、パスワード確認）
        -   削除（論理削除）
    -   期限切れオーナー管理
        -   期限切れオーナー管理
            -   名前、メールアドレス、期限が切れた日を表示
        -   完全に削除（物理削除）
    -   お問い合わせ管理
        -   お問い合わせ管理
            -   問い合わせが送られたユーザーの一覧を表示
        -   お問い合わせ詳細
            -   利用者へお問い合わせの返答を送信
            -   メッセージの送信を取り消し（論理削除）

# 環境構築

## 1. ダウンロード方法

main ブランチをダウンロードする場合

```
git clone https://github.com/yuuhei-koutoku/laravel-ecsite.git
```

ブランチ名を指定してダウンロードする場合

```
git clone -b ブランチ名 https://github.com/yuuhei-koutoku/laravel-ecsite.git
```

もしくは zip ファイルでダウンロードしてください。

## 2. インストール方法

-   `cd laravel_ecsite`
-   `composer install` または `composer update`
-   `npm install`
-   `npm run dev`

`.env.example` をコピーして `.env` ファイルを作成します。

`.env` ファイルの中の下記をご利用の環境に合わせて変更してください。

```
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=8889
DB_DATABASE=laravel-ecsite-db
DB_USERNAME=laravel-ecsite-user
DB_PASSWORD=laravel-ecsite-pass
```

XAMPP/MAMP または他の開発環境で DB を起動した後に`php artisan migrate:fresh --seed`と実行してください。(データベーステーブルとダミーデータが追加されれば OK です。)

最後に`php artisan key:generate`と入力してキーを生成後、`php artisan serve`と`npm run dev`で簡易サーバーを立ち上げ、表示確認してください。

## 3. インストール後の実施事項

### 画像ダミーデータの設定

画像のダミーデータは `public/images` フォルダ内に `product1.jpg` 〜 `product12.jpg` として保存しています。また、画像登録なしの場合のダミーデータは、`no_image.jpg`として保存しています。

`php artisan storage:link` で `storage` フォルダにリンク後、`storage/app/public/products` フォルダ内に保存すると表示されます。（`products` フォルダがない場合は作成してください。）

ショップの画像も表示する場合は、`storage/app/public/shops` フォルダを作成し、`shop1.jpg` 〜 `shop3.jpg` を保存してください。

### 決済のテスト

決済のテストとして Stripe を利用しています。必要な場合は `.env` に Stripe の情報を追記してください。

### メールのテスト

メールのテストとして Mailtrap を利用しています。必要な場合は `.env` に Mailtrap の情報を追記してください。

メール処理には時間がかかるので、 キューを使用しています。必要な場合は `php artisan queue:work` で ワーカーを立ち上げて動作確認するようにしてください。
